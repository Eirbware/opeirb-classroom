---
import { siteConfig, siteMenu } from "../../config";
import { getPageProps } from "../../content";
import pathlib from "path";
import SvgPartial from "./svg.astro";

interface Props {
  fileRelPath?: string
}
const { fileRelPath } = Astro.props;
const footer_params = siteConfig.footer;
const footerMenu = await Promise.all(
  siteMenu.footer.map(async ({name,  url}) => ({
    name: name ?? (await getPageProps(url)).frontmatter.title,
    url
  }))
);
---

<footer class="container text-center my-6 p-8 dark:text-gray3">
  <div
    class="mx-auto w-24 h-1 my-12 bg-gradient-to-r from-gray5 to-gray4 rounded-full"
  ></div>
  { fileRelPath !== undefined && (
  <div class="pt-10">
    { footer_params.issue }
    <a
      class="text-blue-500"
      href={pathlib.join(siteConfig.links.github_content, fileRelPath)}
    >{ footer_params.issue_url_content }</a
    >
  </div>
  )}

  <div class="py-3">
    { footer_params.contact }
    <strong class="text-white font-bold">
      { footer_params.contact_email }
    </strong>
  </div>

  <div class="flex justify-center items-center my-2">
  { Object.entries(siteConfig.links.helpful).map(([k, v]) =>
    <a href={v}>
      <i class="w-6 inline-block mx-2">
        <SvgPartial filestem={k} />
      </i>
    </a>
    )
  }
  </div>

  <h6>{ footer_params.links_title }</h6>

  {footerMenu && (
  <div class="py-3">
    {footerMenu.map(({ name, url }, i) => (
    <>
      <a href={url}>
        {name}
      </a>
      {i < footerMenu.length - 1 && " | "}
    </>
    ))}
  </div>
  )}

  <div class="text-xs">
    Copyright Â© { new Date().getFullYear() } { footer_params.copyright } <br />
  </div>
</footer>
